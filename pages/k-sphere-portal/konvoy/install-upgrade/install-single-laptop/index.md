---
layout: layout.pug
navigationTitle: Install on a single laptop
title: Install on a single laptop
menuWeight: 15
excerpt: Prepare for and install Konvoy on a single laptop virtual infrastructure
enterprise: false
---
You can use Konvoy to deploy Kubernetes using an existing internal network infrastructure.
You can also use Konvoy to deploy Kubernetes on a single laptop using Docker to simulate the internal network deployment work flow without placing any demand on your existing network infrastructure.

In this scenario, you deploy Konvoy using a **Docker provisioner** with Docker containers used to simulate your cluster hosts.

## Before you begin
Before starting the single laptop installation, you should verify the following:

- You have a laptop or workstation with Docker installed.

- Docker is configured with the following minimum requirements for CPU, memory, and disk:
    - 4 CPUs
    - 8 GB memory
    - 40 GB of free disk space

## Provision Konvoy using Docker

1. Run the following command to create a simulated on-prem environment using Docker containers:

    ```bash
    konvoy provision --provisioner=docker
    ```

    This command creates Docker containers.
    Each Docker container simulates a host.

1. Verify the containers created for the cluster by running the following command:

    ```bash
    $ docker ps
    ```

    This command returns information about the Docker contains similar to the following:

    ```
    CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                            NAMES
    f3e55b48d356        f8599341f602        "/usr/local/bin/entr…"   5 seconds ago       Up 3 seconds        0.0.0.0:22000->22/tcp, 0.0.0.0:46000->6443/tcp   konvoy-4cc6-control-plane-0
    8198ec8c2744        f8599341f602        "/usr/local/bin/entr…"   5 seconds ago       Up 3 seconds        0.0.0.0:22010->22/tcp                            konvoy-4cc6-worker-pool0-0
    ```

1. Review the `inventory.yaml` file generated by the `konvoy provision`.

    After running the `konvoy provision` command, you should have an inventory.yaml file with content similar to the following in your current working directory:

    ```yaml
    control-plane:
    hosts:
        172.17.0.3:
        ansible_host: localhost
        ansible_port: 22000

    node:
    hosts:
        172.17.0.2:
        ansible_host: localhost
        ansible_port: 22010
        node_pool: worker

    all:
    vars:
        order: sorted
        control_plane_endpoint: "172.17.0.3:6443"
        ansible_user: root
        ansible_ssh_private_key_file: "/Users/jie/workspace/konvoy/konvoy-ssh.pem"
    ```

1. Deploy Konvoy into the simulated environment by running the following command:

    ```bash
    konvoy deploy
    ```

## Review the differences in the simulated environment

By deploying Kubernetes using Konvoy into the simulated environment, you should note the following differences from deploying on a public cloud infrastructure:

- [MetalLB][1] is used for creating [Service][4] (type `LoadBalancer`).

- [Keepalived][2] is used to provide HA for Kubernetes API servers.

- [Static Local Volume Provisioner][3] is used to create local [Persistent Volumes][5].

If you want to customize the Kubernetes cluster, you can modify `cluster.yaml` in your current working directory, then run `konvoy deploy` again.

## Using a virtual private network for Docker on macOS

If you use Docker on a macOS computer, the host doesn't have direct access to the Docker network.
Because of this limitation, you cannot directly access the services running in Docker containers using their IP addresses.

To access the services in Docker containers when using a macOS computer, you can create a virtual private network (VPN) between the host and the Docker network.

1. Create the virtual private network (VPN) by running the following command:

    ```bash
    curl -sL https://raw.githubusercontent.com/mesosphere/docker-mac-network/master/mac-network.sh | bash -s create
    ```

1. Destroy the virtual private network (VPN) when it is no longer needed by running the following command:

    ```bash
    curl -sL https://raw.githubusercontent.com/mesosphere/docker-mac-network/master/mac-network.sh | bash -s destroy
    ```

[1]: https://metallb.universe.tf/
[2]: https://www.keepalived.org/
[3]: https://github.com/kubernetes-sigs/sig-storage-local-static-provisioner
[4]: https://kubernetes.io/docs/concepts/services-networking/service/
[5]: https://kubernetes.io/docs/concepts/storage/persistent-volumes/