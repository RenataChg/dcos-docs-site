---
layout: layout.pug
navigationTitle:  Working with Linux security profiles
title: Working with Linux security profiles
menuWeight: 31
excerpt: Describes how you can work with Linux secure computing (seccomp) profiles 
enterprise: true
---
<!-- The source repository for this topic is https://github.com/dcos/dcos-docs-site -->

The Linux kernel provides a computer security facility that you can configure to control the operations that can be performed and to prevent untrusted programs from accessing system resources or granting permission to unauthorized users or services. The secure computing mode (seccomp) was developed to enable programs to run safely so that activity taking place in a public grid computing environment would not compromise the systems where the programs run.

1) At install time, provide default SECCOMP Profile for all Docker Containers - https://github.com/moby/moby/blob/v1.13.1/profiles/seccomp/default.json
2) Launch Docker Containers via UCR using SDK and Marathon
3) Out of Band, login to agent node and Verify that the SECCOMP Profile specified above is applied to Docker Containers that were launched using UCR.

Customer has requested that we support the secure computing mode (seccomp) which is a Linux kernel feature used by Docker. Specifically:
https://docs.docker.com/engine/security/seccomp/

This demand is important in order to support auditing requirements generated by CFPB security teams

# Linux Seccomp Support in UCR
The Linux seccomp isolator adds support for installing Seccomp filters for containers launched using the DC/OS Universal Container Runtime (UCR).

Seccomp filter reduces the attack surface of the Linux kernel by providing a mechanism for filtering of certain system calls. Seccomp requires Linux kernel 3.5, or newer.

Seccomp filter is defined by a Seccomp profile which must be compatible with the Docker Seccomp profile format. An example of the Seccomp profile can be found in default.json.

Note: Mesos containerizer uses the pivot_root system call, so it must be specified in the Seccomp profile. Usually, the Docker Seccomp profile contains chroot syscall, so the pivot_root syscall must be added to the same array "names": ["chroot","pivot_root"].

# Agent setup
The Linux Seccomp isolator is loaded when linux/seccomp is present in the agent’s --isolation flag. This isolator requires root privileges to install a Seccomp filter because a Seccomp filter can’t be installed for a non-privileged user without setting no_new_privs bit which leads to side effects.
The --seccomp_config_dir flag specifies the path to the directory containing Seccomp profiles.
The --seccomp_profile_name flag specifies the default Seccomp profile which is applied by default for all Mesos containers. This profile name must be relative to the --seccomp_config_dir. If this flag is omitted, then the default Seccomp profile is not defined and therefore not applied by default.
A possible agent startup invocation could be
sudo mesos-agent --master=<master ip> --ip=<agent ip>
  --work_dir=/var/lib/mesos
  --isolation=linux/seccomp[,other isolation flags]
  --seccomp_config_dir=/etc/mesos/seccomp
  --seccomp_profile_name=default.json

# Task setup
In order for a Mesos task to override the agent’s default Seccomp profile, it should declare the required profile in the LinuxInfo field of its ContainerInfo. For example, if the agent is launched with the default Seccomp profile enabled, a framework can disable Seccomp for a particular task by setting an unconfined field in the corresponding SeccompInfo.
