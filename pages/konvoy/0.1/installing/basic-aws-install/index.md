---
layout: layout.pug
navigationTitle: Basic AWS Install
title: Basic AWS Install
menuWeight: 1
excerpt: 
enterprise: false


---

This section guides you through the basic steps to prepare your environment and install Konvoy on AWS.

## Prerequisites

* A valid AWS account with [credentials configured][aws_credentials]
* The [aws][install_aws] command line utility
* [Docker][install_docker]
* [kubectl][install_kubectl] _v1.14.3 or newer_ (for interacting with the running cluster)

## Installation

After verifying your prerequisites, you can create an AWS Kubernetes cluster by running `konvoy up`.
This command creates your [Amazon EC2][ec2] instances, installs Kubernetes, and installs default add-ons to support your Kubernetes cluster.

Specifically, the `konvoy up` command does the following:

* Provisions three `t3.large` EC2 instances as Kubernetes master nodes
* Provisions four `t3.xlarge` EC2 instances as Kubernetes worker nodes
* Deploys all of the following default add-ons:
  * CoreDNS
  * Velero
  * Calico
  * Helm
  * AWS CSI driver
  * AWS CSI driver storage class
  * Elasticsearch (and Elasticsearch Exporter)
  * Fluent Bit
  * Kibana
  * Prometheus (and Prometheus Adapter)
  * Traefik
  * Kubernetes dashboard
  * Operations portal

This set of configuration options is the recommended environment for small clusters.

## Modifying the cluster name

By default, the cluster name is the name of the folder where your run the `konvoy` command.
The cluster name will be used to tag the provisioned infrastructure and the context when applying the kubeconfig file.
To customize the cluster name, run the following command:

```bash
konvoy up --cluster-name your-specified-name
```

## Master and worker nodes

Master nodes enable you to manage your cluster with the Kubernetes Control Plane.
The Control Plane contains
[various components][control_plane], including the `kube-apiserver`, that [you will interact with through `kubectl`][kubectl].
Having three master nodes makes the cluster
"highly available" to protect against failures.
Worker nodes run your containers in [Kubernetes pods][pods].

## Default addons

The default addons help you manage your Kuberentes cluster by providing monitoring (Prometheus), dashboards (Kubernetes Dashboard), networking (Calico), storage (AWS CSI Driver), and other services.

## Viewing installation operations

As noted above, you start the cluster installation by running the `konvoy up` command.
As the `konvoy up` command runs, you will see output about the operations performed.
The first set of messages you see is the output generated by [Terraform][terraform] as it provisions your nodes.

After the nodes are provisioned, [Ansible][ansible] connects to the EC2 instances and installs Kubernetes in steps called tasks and playbooks.
Near the end of the output, addons are installed.

## Viewing cluster operations

You can access user interfaces to monitor your cluster through the [Operations Portal][ops_portal].
After you run the `konvoy up` command, if the installation is successful, the command output displays the information you need to access the Operations Portal.

For example, you should see information similar to this:

```text
Kubernetes cluster and addons deployed successfully!

Run `konvoy apply kubeconfig` to update kubectl credentials.

Navigate to the URL below to access various services running in the cluster.
  https://lb_addr-12345.us-west-2.elb.amazonaws.com/ops/portal
And login using the credentials below.
  Username: AUTO_GENERATED_USERNAME
  Password: SOME_AUTO_GENERATED_PASSWORD_12345

The dashboard and services may take a few minutes to be accessible.
```

## Checking the files installed

When the `konvoy up` completes its setup operations, the following files are generated:

* `cluster.yaml` - defines the Konvoy configuration for the cluster, where you customize [your cluster provisioning configuration][cluster_provision] and [your addons][addons_config].
* `admin.conf` - is a [kubeconfig file][kubeconfig], which contains credentials to [connect to the `kube-apiserver` of your cluster through `kubectl`][kubectl].
* `inventory.yaml` - is an [Ansible Inventory file][inventory].
* `state` folder - contains Terraform files, including a [state file][state].
* `cluster-name-ssh.pem`/`cluster-name-ssh.pub` - stores the SSH keys used to connect to the EC2 instances.
* `runs` folder - which contains logging information.

[aws_credentials]: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html
[install_aws]: https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html
[install_docker]: https://docs.docker.com/install/
[install_kubectl]: https://kubernetes.io/docs/tasks/tools/install-kubectl/
[prerequisites]: #prerequisites
[cluster_provision]: ./cluster_provision.md
[addons_config]: ./customize_addons.md
[kubectl]: ../operations/kubectl_basics.md
[ops_portal]: ../operations/ops_portal.md
[ec2]: https://aws.amazon.com/ec2/
[control_plane]: https://kubernetes.io/docs/concepts/overview/components/
[pods]: https://kubernetes.io/docs/concepts/workloads/pods/pod/
[terraform]: https://www.terraform.io
[ansible]: https://www.ansible.com
[kubeconfig]: https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/
[inventory]: https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html
[state]: https://www.terraform.io/docs/state/
